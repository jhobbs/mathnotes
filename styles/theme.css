/* Modern theme system using CSS custom properties and modern color spaces */
:root {
  /* Color palette using modern color functions */
  --color-primary: oklch(64% 0.20 252);
  --color-primary-light: oklch(64% 0.20 252 / 0.1);
  --color-primary-dark: oklch(52% 0.22 252);
  
  /* Test HMR - temporary accent color */
  --color-accent: oklch(70% 0.2 30);
  
  /* Semantic colors */
  --color-bg: oklch(98% 0.01 100);
  --color-bg-secondary: oklch(100% 0 0);
  --color-text: oklch(26% 0.02 100);
  --color-text-secondary: oklch(52% 0.03 210);
  --color-heading: oklch(26% 0.02 100);
  --color-link: var(--color-primary);
  --color-border: oklch(91% 0.01 210);
  --color-code-bg: oklch(97% 0.01 210);
  
  /* Error and state colors */
  --color-error: oklch(53% 0.24 29);
  --color-error-bg: oklch(95% 0.09 25);
  --color-error-border: oklch(53% 0.24 29);
  --color-error-text-dark: oklch(35% 0.15 29);
  
  /* UI component colors */
  --color-card-bg: oklch(100% 0 0);
  --color-button-bg: oklch(96% 0.01 100);
  --color-button-hover: oklch(91% 0.01 100);
  --color-button-text: oklch(26% 0.02 100);
  --color-border-light: oklch(94% 0.01 100);
  --color-info-bg: oklch(94% 0.04 220);
  --color-link-hover: oklch(58% 0.22 252);
  
  /* Tooltip colors */
  --color-tooltip-bg: oklch(100% 0 0);
  --color-tooltip-footer-bg: oklch(97% 0.01 100);
  
  /* Math tooltip type colors */
  --color-type-definition: oklch(60% 0.17 252);
  --color-type-theorem: oklch(53% 0.24 25);
  --color-type-proposition: oklch(55% 0.18 300);
  --color-type-lemma: oklch(63% 0.20 40);
  --color-type-corollary: oklch(50% 0.15 142);
  --color-type-example: oklch(52% 0.12 85);
  --color-type-note: oklch(48% 0.06 250);
  
  /* Transparent overlays and effects */
  --color-overlay-light: oklch(0% 0 0 / 0.02);
  --color-overlay-medium: oklch(0% 0 0 / 0.05);
  --color-overlay-dark: oklch(0% 0 0 / 0.1);
  --color-primary-hover: oklch(64% 0.20 252 / 0.1);
  --color-primary-active: oklch(64% 0.20 252 / 0.2);
  --color-spinner-border: oklch(0% 0 0 / 0.1);
  
  /* Named color replacements */
  --color-white: oklch(100% 0 0);
  --color-black: oklch(0% 0 0);
  
  /* Math block colors using oklch for better perceptual uniformity */
  --color-definition: oklch(56% 0.13 252);
  --color-theorem: oklch(60% 0.15 142);
  --color-lemma: oklch(58% 0.14 241);
  --color-proposition: oklch(62% 0.12 230);
  --color-corollary: oklch(54% 0.08 250);
  --color-proof: oklch(40% 0.05 250);
  --color-example: oklch(55% 0.13 150);
  --color-remark: oklch(50% 0.06 250);
  --color-note: oklch(50% 0.06 250);
  --color-intuition: oklch(65% 0.12 180);
  --color-exercise: oklch(56% 0.13 252);
  --color-solution: oklch(50% 0.06 250);
  
  /* Nested math block overlays */
  --color-nested-definition: oklch(56% 0.13 252 / 0.03);
  --color-nested-theorem: oklch(60% 0.15 142 / 0.03);
  --color-nested-lemma: oklch(58% 0.14 241 / 0.03);
  --color-nested-proposition: oklch(62% 0.12 230 / 0.03);
  --color-nested-corollary: oklch(54% 0.08 250 / 0.025);
  --color-nested-proof: oklch(40% 0.05 250 / 0.03);
  --color-nested-example: oklch(55% 0.13 150 / 0.03);
  
  /* Embedded block overlays */
  --color-embedded-bg: oklch(0% 0 0 / 0.03);
  
  /* Spacing scale */
  --space-3xs: 0.125rem;  /* 2px */
  --space-2xs: 0.375rem;  /* 6px */
  --space-xs: 0.25rem;    /* 4px */
  --space-sm: 0.5rem;     /* 8px */
  --space-md: 1rem;       /* 16px */
  --space-lg: 1.5rem;     /* 24px */
  --space-xl: 2rem;       /* 32px */
  --space-2xl: 3rem;      /* 48px */
  --space-3xl: 4rem;      /* 64px */
  
  /* Micro spacing for precise UI adjustments */
  --space-micro-1: 2px;
  --space-micro-2: 4px;
  --space-micro-3: 6px;
  --space-micro-4: 8px;
  --space-micro-5: 10px;
  --space-micro-6: 12px;
  
  /* Typography scale */
  --font-size-xs: 0.75rem;
  --font-size-sm: 0.875rem;
  --font-size-base: 1rem;
  --font-size-lg: 1.125rem;
  --font-size-xl: 1.25rem;
  --font-size-2xl: 1.5rem;
  --font-size-3xl: 2rem;
  
  /* Line heights */
  --line-height-tight: 1.25;
  --line-height-base: 1.6;
  --line-height-relaxed: 1.8;
  
  /* Border radius */
  --radius-sm: 3px;
  --radius-md: 6px;
  --radius-lg: 8px;
  --radius-full: 9999px;
  
  /* Shadows */
  --shadow-sm: 0 1px 2px 0 oklch(0% 0 0 / 0.05);
  --shadow-md: 0 4px 6px -1px oklch(0% 0 0 / 0.1);
  --shadow-lg: 0 10px 15px -3px oklch(0% 0 0 / 0.1);
  --shadow-xl: 0 20px 25px -5px oklch(0% 0 0 / 0.1);
  
  /* Transitions */
  --transition-fast: 150ms ease;
  --transition-base: 200ms ease;
  --transition-slow: 300ms ease;
  
  /* Z-index scale */
  --z-base: 0;
  --z-dropdown: 100;
  --z-sticky: 200;
  --z-overlay: 300;
  --z-modal: 400;
  --z-tooltip: 500;
  
  /* Border widths */
  --border-width-thin: 1px;
  --border-width-base: 2px;
  --border-width-thick: 3px;
  --border-width-heavy: 4px;
  --border-width-extra: 5px;
  
  /* Border radius */
  --radius-xs: 3px;
  --radius-sm: 4px;
  --radius-md: 6px;
  --radius-lg: 8px;
  --radius-xl: 12px;
  --radius-2xl: 16px;
  --radius-full: 9999px;
  
  /* Component sizes */
  --size-input-sm: 100px;
  --size-input-base: 120px;
  --size-input-md: 160px;
  --size-input-lg: 200px;
  --size-button-icon: 16px;
  --size-thumb: 15px;
  --size-slider-track: 4px;
  
  /* Content widths */
  --width-content-base: 1200px;
  --width-content-wide: 1440px;
  --width-grid-min: 250px;
  --width-grid-min-sm: 150px;
  --width-card-min: 350px;
  
  /* Heights */
  --height-input-min: 60px;
  --height-card-sm: 200px;
  --height-card-base: 300px;
  --height-demo-min: 300px;
  
  /* Gaps and gutters */
  --gap-xs: 10px;
  --gap-sm: 15px;
  --gap-base: 20px;
  --gap-lg: 30px;
  --gap-xl: 40px;
  --gap-2xl: 50px;
  
  /* Breakpoints */
  /* Note: These values are also hardcoded in main.css @custom-media rules
     because CSS custom properties don't work in @custom-media at-rules */
  --breakpoint-phone: 640px;
  --breakpoint-tablet: 768px;
  --breakpoint-desktop: 1024px;
  --breakpoint-wide: 1440px;
  
  /* Transform values */
  --translate-subtle: -1px;
  --translate-sm: -2px;
  --translate-base: 1rem;
  
  /* Outline offsets */
  --outline-offset-sm: 2px;
  --outline-offset-base: 3px;
}

/* Dark theme */
@media (prefers-color-scheme: dark) {
  :root {
    --color-bg: oklch(15% 0.02 240);
    --color-bg-secondary: oklch(15% 0.02 240);
    --color-text: oklch(85% 0.01 210);
    --color-text-secondary: oklch(65% 0.02 210);
    --color-heading: oklch(96% 0.01 210);
    --color-link: oklch(73% 0.15 220);
    --color-border: oklch(30% 0.01 210);
    --color-code-bg: oklch(18% 0.02 240);
    
    /* Error and state colors for dark mode */
    --color-error: oklch(67% 0.24 25);
    --color-error-bg: oklch(25% 0.10 25);
    --color-error-border: oklch(67% 0.24 25);
    --color-error-text-dark: oklch(90% 0.09 25);
    
    /* UI component colors for dark mode */
    --color-card-bg: oklch(22% 0.02 240);
    --color-button-bg: oklch(28% 0.02 240);
    --color-button-hover: oklch(34% 0.02 240);
    --color-button-text: oklch(100% 0 0);
    --color-border-light: oklch(26% 0.01 240);
    --color-info-bg: oklch(20% 0.05 220);
    --color-link-hover: oklch(68% 0.17 220);
    
    /* Tooltip colors for dark mode */
    --color-tooltip-bg: oklch(18% 0.02 240);
    --color-tooltip-footer-bg: oklch(15% 0.02 240);
    
    /* Math tooltip type colors for dark mode */
    --color-type-definition: oklch(73% 0.15 220);
    --color-type-theorem: oklch(67% 0.24 25);
    --color-type-proposition: oklch(75% 0.15 300);
    --color-type-lemma: oklch(72% 0.17 40);
    --color-type-corollary: oklch(65% 0.12 142);
    --color-type-example: oklch(70% 0.10 85);
    --color-type-note: oklch(65% 0.04 250);
    
    /* Transparent overlays for dark mode */
    --color-overlay-light: oklch(100% 0 0 / 0.02);
    --color-overlay-medium: oklch(100% 0 0 / 0.05);
    --color-overlay-dark: oklch(100% 0 0 / 0.1);
    --color-primary-hover: oklch(73% 0.15 220 / 0.1);
    --color-primary-active: oklch(73% 0.15 220 / 0.2);
    --color-spinner-border: oklch(100% 0 0 / 0.1);
    
    /* Adjusted math colors for dark mode */
    --color-definition: oklch(65% 0.13 252);
    --color-theorem: oklch(68% 0.15 142);
    --color-lemma: oklch(66% 0.14 241);
    --color-proposition: oklch(70% 0.12 230);
    --color-corollary: oklch(62% 0.08 250);
    --color-proof: oklch(55% 0.05 250);
    --color-example: oklch(63% 0.13 150);
    --color-remark: oklch(60% 0.06 250);
    --color-note: oklch(60% 0.06 250);
    --color-intuition: oklch(72% 0.12 180);
    --color-exercise: oklch(65% 0.13 252);
    --color-solution: oklch(60% 0.06 250);
    
    /* Nested math block overlays for dark mode */
    --color-nested-definition: oklch(65% 0.13 252 / 0.06);
    --color-nested-theorem: oklch(68% 0.15 142 / 0.06);
    --color-nested-lemma: oklch(66% 0.14 241 / 0.06);
    --color-nested-proposition: oklch(70% 0.12 230 / 0.06);
    --color-nested-corollary: oklch(62% 0.08 250 / 0.05);
    --color-nested-proof: oklch(55% 0.05 250 / 0.06);
    --color-nested-example: oklch(63% 0.13 150 / 0.06);
    
    /* Embedded block overlays for dark mode */
    --color-embedded-bg: oklch(100% 0 0 / 0.03);
    
    /* Darker shadows for dark mode */
    --shadow-sm: 0 1px 2px 0 oklch(0% 0 0 / 0.2);
    --shadow-md: 0 4px 6px -1px oklch(0% 0 0 / 0.3);
    --shadow-lg: 0 10px 15px -3px oklch(0% 0 0 / 0.4);
    --shadow-xl: 0 20px 25px -5px oklch(0% 0 0 / 0.5);
  }
}

/* Utility classes for theme values */
.theme-primary { color: var(--color-primary); }
.theme-bg-primary { background-color: var(--color-primary); }
.theme-border-primary { border-color: var(--color-primary); }